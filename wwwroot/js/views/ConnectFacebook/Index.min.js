!function(o,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.vjs=e():o.vjs=e()}(self,(()=>(()=>{"use strict";var o={28:(o,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WEBHOOKS=e.PERMISSIONS=void 0,e.PERMISSIONS=["email","public_profile","business_management","pages_show_list","pages_manage_metadata","pages_messaging","pages_manage_posts","instagram_basic","instagram_content_publish","instagram_manage_messages"],e.WEBHOOKS=["messages"]}},e={};function n(t){var s=e[t];if(void 0!==s)return s.exports;var a=e[t]={exports:{}};return o[t](a,a.exports,n),a.exports}var t={};return(()=>{var o=t;Object.defineProperty(o,"__esModule",{value:!0});const e=n(28);var s,a,i,c,r;function l(o){var e,n,t,s;console.log("statusChangeCallback"),"connected"===(null==o?void 0:o.status)?($("#loginBtn").hide(),$("#logoutBtn").show(),FB.api("/me",{fields:"name"},(function(o){$("#page-headline").text("Good to have you back, "+o.name+"!")})),$("#page-var-text").text("Corprio Social Worker can now do the following: "),FB.api("/me/accounts",(function(o){if(o&&!o.error)for(let e=0;e<o.data.length;e++)g(o.data[e].id,o.data[e].access_token);else console.error(o.error)})),t=null===(e=o.authResponse)||void 0===e?void 0:e.userID,s=null===(n=o.authResponse)||void 0===n?void 0:n.accessToken,$.post({url:vdata.actions.refreshAccessToken,data:{metaId:t,token:s}}).done((function(){console.log(`Token for ${t} is fed to backend successfully.`)})).fail((function(){console.log(`Failed to pass the token for ${t} to backend.`)}))):($("#loginBtn").show(),$("#logoutBtn").hide(),$("#page-headline").text("Welcome to Corprio Social Worker!"),$("#page-var-text").text("Click the login button below to connect your Facebook page(s) and Instagram accounts with Corprio. Once it is done, Corprio Social Worker can do the following magic for you: "))}function u(){FB.getLoginStatus((function(o){l(o)}))}function g(o,n){return console.log(`Subscribing to page ${o}`),FB.api(`/${o}/subscribed_apps`,"post",{subscribed_fields:e.WEBHOOKS,access_token:n},(function(e){if(console.log("Response from subscribed_apps:"),console.log(e),e&&!e.error)return function(o,e){return console.log(`Turning on NLP for page ${o}`),FB.api(`/${o}/nlp_configs`,"post",{nlp_enabled:!0,model:"CHINESE",access_token:e},(function(o){console.log("Response from nlp_configs:"),console.log(o)}))}(o,n)}))}window.fbAsyncInit=function(){FB.init({appId:"312852768233605",cookie:!0,xfbml:!0,version:"v18.0"}),FB.getLoginStatus((function(o){l(o)}))},a="script",i="facebook-jssdk",r=(s=document).getElementsByTagName(a)[0],s.getElementById(i)||((c=s.createElement(a)).id=i,c.src="https://connect.facebook.net/en_US/sdk.js",r.parentNode.insertBefore(c,r)),document.addEventListener("DOMContentLoaded",(o=>{console.log("DOM fully loaded and parsed"),$("#loginBtn").on("click",(function(){console.log("Logging into Facebook..."),FB.login((o=>{o.authResponse&&u()}),{scope:e.PERMISSIONS.toString(),return_scopes:!0})})),$("#logoutBtn").on("click",(function(){console.log("Logging out from Facebook..."),FB.logout(u)}))}))})(),t})()));