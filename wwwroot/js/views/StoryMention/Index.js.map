{"version":3,"file":"Index.js","mappings":"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","sources":["webpack://vjs/webpack/universalModuleDefinition","webpack://vjs/./Views/Shared/Constants.ts","webpack://vjs/webpack/bootstrap","webpack://vjs/./Views/StoryMention/Index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"vjs\"] = factory();\n\telse\n\t\troot[\"vjs\"] = factory();\n})(self, () => {\nreturn ","//export const PERMISSIONS: string[] = ['email', 'public_profile', 'business_management', 'pages_manage_metadata',\r\n//    'pages_messaging', 'pages_manage_posts', 'pages_manage_engagement', 'instagram_basic', 'instagram_content_publish',\r\n//    'instagram_manage_comments', 'instagram_manage_messages'];\r\n\r\n/**\r\n * updates on 8 Feb 2024:\r\n * - advanced access for 'instagram_manage_comments' is NOT required for receiving webhook triggered by no-role users\r\n * - advanced access for 'pages_messaging' is NOT required for sending messages to no-role users\r\n * - advanced access for 'instagram_manage_messages' is required for sending messages to no-role users\r\n * - 'business_management' is required for viewing pages managed by the user\r\n * - 'pages_read_engagement' is required for creating posts on FB pages\r\n * - 'pages_manage_metadata' is required for managing webhooks\r\n * - 'pages_read_user_content' is required for reading comments on posts on FB pages\r\n * - 'pages_manage_engagement' is retained for making comments on other comments on FB pages\r\n */\r\n//export const PERMISSIONS: string[] = ['email', 'public_profile', 'business_management', 'pages_show_list', 'pages_manage_metadata',\r\n//    'pages_messaging', 'pages_manage_posts', 'instagram_basic', 'instagram_content_publish', 'pages_manage_engagement',\r\n//    'instagram_manage_comments', 'instagram_manage_messages', 'pages_read_engagement', 'pages_read_user_content'];\r\n\r\nexport const PERMISSIONS: string[] = ['email', 'public_profile', 'business_management', 'pages_show_list', 'pages_manage_metadata',\r\n    'pages_messaging', 'pages_manage_posts', 'instagram_basic', 'instagram_content_publish', 'instagram_manage_messages'];\r\n\r\nexport const WEBHOOKS: string[] = [\r\n    /*'feed',*/\r\n    // webhook for pages: https://developers.facebook.com/docs/graph-api/webhooks/getting-started/webhooks-for-pages/\r\n    'messages', 'mention',\r\n    // any other webhook event: https://developers.facebook.com/docs/messenger-platform/webhook/#events\r\n];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import { PERMISSIONS, WEBHOOKS } from '../Shared/Constants';\r\n\r\ndeclare const vdata: {\r\n    localizer: {\r\n        error: string;\r\n        fbAlreadyConnected: string;\r\n        fbConnected: string;\r\n        fbNotConnected: string;\r\n        storyMentionCreator: string;\r\n        storyMentionDate: string;\r\n        storyMentionHint: string;\r\n        storyMentionMentioned: string;\r\n    };\r\n    settings: {\r\n        appBaseUrl: string;\r\n        metaApiID: string;\r\n        metaApiVersion: string;\r\n        organizationID: string;\r\n        shortName: string;\r\n    };\r\n    url: {\r\n        getPage: string;\r\n        testCDN: string;\r\n    };\r\n};\r\n\r\n// https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/facebook-js-sdk/index.d.ts\r\n/// <reference types=\"facebook-js-sdk\" />\r\n\r\n\r\n/**\r\n * React to change in the user's Facebook login status\r\n * @param response-Facebook's response to getLoginStatus()\r\n */\r\nfunction handleFbLoginStatusChange(response: facebook.StatusResponse) {\r\n    /*console.log(response);*/\r\n    if (response?.status === 'connected') {                \r\n        $('#loginBtn').hide();\r\n        $('#logoutBtn').show();\r\n        FB.api('/me', { fields: 'name' }, function (response: facebook.User) {            \r\n            const alert =\r\n                `<div class=\"alert alert-success my-3\">` +\r\n                    `<i class=\"fa-regular fa-circle-check\"></i>` +\r\n                    `&nbsp;${vdata.localizer.fbConnected.replaceAll('{0}', response.name).replaceAll('{1}', vdata.settings.shortName)}` +\r\n                `</div>`\r\n            $('#fb-dialogue').empty().append(alert);\r\n            $('#mentions').show();\r\n            //$.ajax({\r\n            //    url: vdata.url.getPage,\r\n            //    method: 'GET',\r\n            //    data: { metaUserId: response.id },\r\n            //    success: function (data) {\r\n            //        console.log('mentions:');\r\n            //        console.log(data);\r\n            //    }\r\n            //});\r\n\r\n            $('#mentions').dxDataGrid({\r\n                dataSource: {\r\n                    store: {\r\n                        type: 'odata',\r\n                        version: 2,\r\n                        url: vdata.url.getPage,                        \r\n                        beforeSend(request) {\r\n                            request.params.metaUserId = response.id;\r\n                        },\r\n                    },\r\n                },\r\n                paging: { pageSize: 10 },\r\n                pager: {\r\n                    showPageSizeSelector: true,\r\n                    allowedPageSizes: [10, 25, 50, 100],\r\n                },\r\n                remoteOperations: false,\r\n                searchPanel: {\r\n                    visible: true,\r\n                    highlightCaseSensitive: true,\r\n                },\r\n                /*groupPanel: { visible: true },*/\r\n                grouping: { autoExpandAll: false },\r\n                allowColumnReordering: true,\r\n                rowAlternationEnabled: true,\r\n                showBorders: true,\r\n                width: '100%',\r\n                columns: [\r\n                    {\r\n                        dataField: 'CreateDate',\r\n                        caption: vdata.localizer.storyMentionDate,\r\n                        dataType: 'datetime',\r\n                        sortOrder: 'desc'\r\n                    },\r\n                    {\r\n                        dataField: 'Mentioned',\r\n                        caption: vdata.localizer.storyMentionMentioned,\r\n                        dataType: 'string'\r\n                    },\r\n                    {\r\n                        dataField: 'CreatorName',\r\n                        caption: vdata.localizer.storyMentionCreator,\r\n                        dataType: 'string'\r\n                    },                    \r\n                    {\r\n                        type: 'buttons',\r\n                        buttons: [{\r\n                            name: 'Story',\r\n                            icon: 'find',\r\n                            hint: vdata.localizer.storyMentionHint,\r\n                            onClick: function (e) {\r\n                                window.open(e.row.data.CDNUrl, '_blank');                                \r\n                            }\r\n                        }]\r\n                    }\r\n                    \r\n                ],                \r\n            });\r\n        });\r\n        /*The following functions run in a non-blocking manner because there is no interdependence*/\r\n        getPages();        \r\n    } else {                \r\n        $('#loginBtn').show();\r\n        $('#logoutBtn').hide();\r\n        const alert =\r\n            `<div class=\"alert alert-warning\">` +\r\n                `<i class=\"fa-regular fa-circle-exclamation\"></i>` +\r\n                `&nbsp;${vdata.localizer.fbNotConnected.replaceAll('{0}', vdata.settings.shortName)}` +\r\n            `</div>`\r\n        $('#fb-dialogue').empty().append(alert);\r\n        $('#mentions').hide();   \r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Check the user's FB login status\r\n */\r\nfunction checkLoginState() {\r\n    FB.getLoginStatus(function (response) {\r\n        handleFbLoginStatusChange(response)\r\n    })\r\n}\r\n\r\n/**\r\n * Turn on Meta's Built-in NLP to help detect locale (and meaning)\r\n * (note: we run this function on the client side to reduce workload on the server side)\r\n * https://developers.facebook.com/docs/graph-api/reference/page/nlp_configs/\r\n * https://developers.facebook.com/docs/messenger-platform/built-in-nlp/\r\n * @param page_id-ID of Facebook page\r\n * @param page_access_token-Page access token\r\n * @returns\r\n */\r\nfunction turnOrNLP(page_id: string, page_access_token: string) {\r\n    console.log(`Turning on NLP for page ${page_id}`);\r\n    return FB.api(\r\n        `/${page_id}/nlp_configs`,\r\n        'post',\r\n        {\r\n            nlp_enabled: true,\r\n            model: 'CHINESE',\r\n            access_token: page_access_token\r\n        },\r\n        function (response: any) {\r\n            console.log('Response from nlp_configs:');\r\n            console.log(response);\r\n        }\r\n    );\r\n}\r\n\r\n/**\r\n * Add webhooks to page subscriptions (IMPORTANT: subscribe to the fields as those subscribed on App level)\r\n * (note: we run this function on the client side to reduce workload on the server side)\r\n * https://developers.facebook.com/docs/messenger-platform/webhooks/#connect-your-app\r\n * @param page_id-ID of Facebook page\r\n * @param page_access_token-Page access token\r\n * @returns\r\n */\r\nfunction addPageSubscriptions(page_id: string, page_access_token: string) {\r\n    console.log(`Subscribing to page ${page_id}`);\r\n    return FB.api(\r\n        `/${page_id}/subscribed_apps`,\r\n        'post',\r\n        {\r\n            subscribed_fields: WEBHOOKS,\r\n            access_token: page_access_token,\r\n        },\r\n        function (response: any) {\r\n            console.log('Response from subscribed_apps:');\r\n            console.log(response);\r\n            if (response && !response.error) {\r\n                return turnOrNLP(page_id, page_access_token);\r\n            }\r\n        },\r\n    )\r\n}\r\n\r\n/**\r\n * Query the pages on which the user has a role and trigger webhook subscription for each of them  \r\n */\r\nfunction getPages() {\r\n    FB.api('/me/accounts', function (response: facebook.AuthResponse | any) {\r\n        if (response && !response.error) {\r\n            /*console.log('response from getPages()...');*/\r\n            /*console.log({ response });*/\r\n            for (let i = 0; i < response.data.length; i++) {\r\n                const page_id = response.data[i].id;\r\n                const page_access_token = response.data[i].access_token;\r\n                addPageSubscriptions(page_id, page_access_token);\r\n            }\r\n        } else {\r\n            console.error(response.error);\r\n        }\r\n    })\r\n}\r\n\r\n// The order of the following three code blocks is extremely important. It has to be:\r\n// (1) fbAsyncInit, (2) IIFE, then (3) whatever needs to run upon DOM being loaded\r\n// For reference, see: https://www.devils-heaven.com/facebook-javascript-sdk-login\r\nwindow.fbAsyncInit = function () {    \r\n    FB.init({\r\n        appId: vdata.settings.metaApiID,\r\n        cookie: true,  // Enable cookies to allow the server to access the session.\r\n        xfbml: true,  // Parse social plugins on this webpage.\r\n        version: vdata.settings.metaApiVersion\r\n    });\r\n\r\n    FB.getLoginStatus(function (response) {   // Called after the JS SDK has been initialized.\r\n        handleFbLoginStatusChange(response);        // Returns the login status.\r\n    });\r\n};\r\n\r\n/**\r\n * IIFE to make a reference to the SDK, if it does not already exist\r\n */\r\n(function (element: Document, tagName: string, selector: string) {\r\n    var js, fjs = element.getElementsByTagName(tagName)[0];\r\n    if (element.getElementById(selector)) { return; }\r\n    js = element.createElement(tagName); js.id = selector;\r\n    js.src = \"https://connect.facebook.net/en_US/sdk.js\";\r\n    fjs.parentNode.insertBefore(js, fjs);\r\n}(document, 'script', 'facebook-jssdk')\r\n);\r\n\r\n/**\r\n * Entry point\r\n */\r\n$(function () {\r\n    \r\n\r\n    /*corprio.page.initTour({ defaultTour: 'getstarted.index', autoStart: true });*/\r\n\r\n    // facebook-related stuff\r\n    $('#loginBtn').on('click', function () {\r\n        console.log('Logging into Facebook...');\r\n        FB.login((response: facebook.StatusResponse) => {            \r\n            if (response.authResponse) {\r\n                //user just authorized your app                \r\n                checkLoginState();\r\n            }\r\n        }, {\r\n            scope: PERMISSIONS.toString(),\r\n            return_scopes: true\r\n        });\r\n    });\r\n\r\n    $('#logoutBtn').on('click', function () {\r\n        console.log('Logging out from Facebook...')\r\n        FB.logout(checkLoginState);\r\n    }); \r\n    \r\n});"],"names":[],"sourceRoot":""}